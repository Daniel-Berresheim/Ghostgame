[gd_scene load_steps=4 format=2]

[ext_resource path="res://resources/entities/Possessable.tscn" type="PackedScene" id=1]

[sub_resource type="GDScript" id=1]

script/source = "extends KinematicBody2D

export var gravity = Vector2(0, 1);

onready var _p = $\"Possessable\";
var _speed = Vector2(0, 0);

func _ready():
	set_process(false);
	
	_p.connect(\"possessed\", self, \"_possessed\");
	_p.connect(\"unpossessed\", self, \"_unpossessed\");

func _process(delta):
	var movement = Vector2(0, 0);
	if Input.is_action_pressed(\"move_left\"):
		movement.x -= 1 * delta;
	if Input.is_action_pressed(\"move_right\"):
		movement.x += 1 * delta;
	
	_speed += movement;
	_speed += gravity * delta;
	
	move_and_slide(_speed);

func _possessed(player):
	set_process(true);

func _unpossessed(player):
	set_process(false);"

[sub_resource type="CircleShape2D" id=2]

custom_solver_bias = 0.0
radius = 24.0

[node name="Moveable" type="KinematicBody2D"]

input_pickable = false
collision_layer = 8
collision_mask = 11
collision/safe_margin = 0.08
script = SubResource( 1 )
_sections_unfolded = [ "Collision" ]
gravity = Vector2( 0, 1 )

[node name="Possessable" parent="." index="0" instance=ExtResource( 1 )]

[node name="CollisionShape" type="CollisionShape2D" parent="Possessable" index="1"]

shape = SubResource( 2 )


